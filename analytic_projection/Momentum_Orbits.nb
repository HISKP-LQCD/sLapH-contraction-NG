(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     15891,        428]
NotebookOptionsPosition[     14655,        400]
NotebookOutlinePosition[     14989,        415]
CellTagsIndexPosition[     14946,        412]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Momentum Orbits", "Title",
 CellChangeTimes->{{3.7746090605615473`*^9, 
  3.7746090651085787`*^9}},ExpressionUUID->"3211ee80-6e7c-4174-8462-\
97c45d3a4184"],

Cell["\<\
We have the problem that the same operator (up to a phase) comes out for \
different relative momenta. In this notebook we develop the functions that \
removes the duplicates, most documentation is to be found in the manual.\
\>", "Text",
 CellChangeTimes->{{3.7746090674623613`*^9, 
  3.7746091710922823`*^9}},ExpressionUUID->"5223c4cb-0aa5-40f4-b656-\
5e7cbe94a84a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"<<", " ", "sLapHProjection`"}], ";"}]}], "Input",
 CellChangeTimes->{{3.774609174852429*^9, 3.7746092048754997`*^9}, {
  3.7746092474047823`*^9, 3.7746092526716833`*^9}},
 CellLabel->
  "In[146]:=",ExpressionUUID->"8b42a5b2-8c76-400b-9ec7-4cf13d4f0951"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"utm2", " ", "=", " ", 
   RowBox[{"UniqueTotalMomenta", " ", "/@", " ", 
    RowBox[{"Range", "[", 
     RowBox[{"0", ",", "4"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"utm2Flat", " ", "=", " ", 
   RowBox[{"Flatten", "[", 
    RowBox[{"utm2", ",", " ", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"relMomenta", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"{", "#", "}"}], "&"}], " ", "/@", " ", "utm2Flat"}]}]}], "Input",\

 CellChangeTimes->{{3.763551582897471*^9, 3.763551594364523*^9}, {
   3.763553000751556*^9, 3.76355302186732*^9}, {3.763553109654708*^9, 
   3.763553109747712*^9}, {3.763553142524475*^9, 3.763553178635755*^9}, {
   3.763553220959593*^9, 3.763553241907425*^9}, {3.7635533193193398`*^9, 
   3.763553326299374*^9}, {3.763554063900766*^9, 3.763554064079431*^9}, {
   3.763555494868479*^9, 3.763555512688219*^9}, {3.7635555529248466`*^9, 
   3.763555553009796*^9}, {3.7635556338641043`*^9, 3.7635556340110397`*^9}, {
   3.763555791371109*^9, 3.7635557915214148`*^9}, 3.7635559951535177`*^9, {
   3.763639014181016*^9, 3.763639015799609*^9}, 3.774697025175623*^9},
 CellLabel->"In[3]:=",ExpressionUUID->"618912da-8c58-47bd-8585-310010ac88ac"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0"}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "1"}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", 
      RowBox[{"-", "1"}]}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"1", ",", "0", ",", "0"}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1", ",", "0"}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{"-", "1"}], ",", "0"}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1", ",", "0"}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{"-", "1"}], ",", "0"}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "1", ",", "0"}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1"}], ",", 
      RowBox[{"-", "1"}], ",", "0"}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1", ",", "1"}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1", ",", 
      RowBox[{"-", "1"}]}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{"-", "1"}], ",", "1"}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{"-", "1"}], ",", 
      RowBox[{"-", "1"}]}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"1", ",", "0", ",", "1"}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"1", ",", "0", ",", 
      RowBox[{"-", "1"}]}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "0", ",", 
      RowBox[{"-", "1"}]}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "0", ",", "1"}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1", ",", "1"}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{"-", "1"}], ",", 
      RowBox[{"-", "1"}]}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "1", ",", 
      RowBox[{"-", "1"}]}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1"}], ",", 
      RowBox[{"-", "1"}], ",", "1"}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{"-", "1"}], ",", "1"}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1", ",", 
      RowBox[{"-", "1"}]}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "1", ",", "1"}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1"}], ",", 
      RowBox[{"-", "1"}], ",", 
      RowBox[{"-", "1"}]}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "2"}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", 
      RowBox[{"-", "2"}]}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"2", ",", "0", ",", "0"}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "2"}], ",", "0", ",", "0"}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"0", ",", "2", ",", "0"}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{"-", "2"}], ",", "0"}], "}"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.7746095065975323`*^9, 3.77469702652206*^9, 
  3.775190694209734*^9},
 CellLabel->"Out[5]=",ExpressionUUID->"752c8241-26a7-425f-90b6-62bf9d754169"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"totalMomentum", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{"0", ",", " ", "0", ",", " ", "2"}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"individualMomenta", " ", "=", " ", 
  RowBox[{"Select", "[", 
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"RelativeToIndividualMomenta", "[", 
        RowBox[{"totalMomentum", ",", "#"}], "]"}], "&"}], ",", 
      "relMomenta"}], "]"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"MomentaMaxNorm", " ", "@", " ", "#"}], " ", "<", " ", "4"}], 
     " ", "&"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"unique", " ", "=", " ", 
  RowBox[{
  "RemoveRedundantMomenta", " ", "@", " ", 
   "individualMomenta"}]}], "\[IndentingNewLine]", 
 RowBox[{"assoc", " ", "=", " ", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"keys", " ", "=", " ", 
       RowBox[{
       "RelMomentaRefLabelFromIndividual", " ", "/@", " ", "unique"}]}], ",", 
      " ", 
      RowBox[{"values", " ", "=", " ", 
       RowBox[{"MomentaOrbit", " ", "/@", " ", "unique"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"AssociationThread", "[", 
     RowBox[{"keys", ",", " ", "values"}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"assocForward", " ", "=", " ", 
  RowBox[{"Map", "[", 
   RowBox[{"RelMomentaRefLabelFromIndividual", ",", " ", "assoc", ",", " ", 
    RowBox[{"{", "2", "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{" ", 
  RowBox[{"Merge", "[", 
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{"reverse", ",", " ", 
      RowBox[{"Normal", " ", "@", " ", "assocForward"}]}], "]"}], ",", " ", 
    "First"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.7752020406092873`*^9, 3.775202067161572*^9}, {
  3.7752026902896214`*^9, 3.7752027665792027`*^9}},
 CellLabel->
  "In[133]:=",ExpressionUUID->"7e456071-e75c-42c1-a031-79c90d92c02b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"assocReverseForTotalMomentum", "[", "totalMomentum_", "]"}], ":=",
     "\[IndentingNewLine]", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"unique", " ", "=", " ", 
        RowBox[{"RemoveRedundantMomenta", " ", "@", " ", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"RelativeToIndividualMomenta", "[", 
             RowBox[{"totalMomentum", ",", "#"}], "]"}], "&"}], ",", 
           "relMomenta"}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"assoc", " ", "=", " ", 
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"keys", " ", "=", " ", 
               RowBox[{
               "RelMomentaRefLabelFromIndividual", " ", "/@", " ", 
                "unique"}]}], ",", " ", 
              RowBox[{"values", " ", "=", " ", 
               RowBox[{"MomentaOrbit", " ", "/@", " ", "unique"}]}]}], "}"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"AssociationThread", "[", 
             RowBox[{"keys", ",", " ", "values"}], "]"}]}], "]"}]}], "}"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"assocForward", " ", "=", " ", 
            RowBox[{"Map", "[", 
             RowBox[{
             "RelMomentaRefLabelFromIndividual", ",", " ", "assoc", ",", " ", 
              
              RowBox[{"{", "2", "}"}]}], "]"}]}], "}"}], ",", 
          "\[IndentingNewLine]", " ", 
          RowBox[{"Merge", "[", 
           RowBox[{
            RowBox[{"Map", "[", 
             RowBox[{"reverse", ",", " ", 
              RowBox[{"Normal", " ", "@", " ", "assocForward"}]}], "]"}], ",",
             " ", "First"}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"assocReverseForTotalMomentum", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", " ", "0", ",", " ", "2"}], "}"}], "]"}]}], "Input",
 CellChangeTimes->{{3.775201241747497*^9, 3.7752013840650883`*^9}, {
   3.775201484980089*^9, 3.775201486733403*^9}, {3.775201541622395*^9, 
   3.775201566928939*^9}, {3.7752016296141977`*^9, 3.775201676649797*^9}, 
   3.775201887257545*^9, {3.77520202591101*^9, 3.7752020260013113`*^9}},
 CellLabel->
  "In[151]:=",ExpressionUUID->"887fbf27-7f99-442a-9421-04b5f53fdf2d"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"000\"\>", "\[Rule]", "\<\"000\"\>"}], ",", 
   RowBox[{"\<\"001\"\>", "\[Rule]", "\<\"001\"\>"}], ",", 
   RowBox[{"\<\"00-1\"\>", "\[Rule]", "\<\"00-1\"\>"}], ",", 
   RowBox[{"\<\"100\"\>", "\[Rule]", "\<\"100\"\>"}], ",", 
   RowBox[{"\<\"010\"\>", "\[Rule]", "\<\"100\"\>"}], ",", 
   RowBox[{"\<\"0-10\"\>", "\[Rule]", "\<\"100\"\>"}], ",", 
   RowBox[{"\<\"-100\"\>", "\[Rule]", "\<\"100\"\>"}], ",", 
   RowBox[{"\<\"110\"\>", "\[Rule]", "\<\"110\"\>"}], ",", 
   RowBox[{"\<\"1-10\"\>", "\[Rule]", "\<\"110\"\>"}], ",", 
   RowBox[{"\<\"-110\"\>", "\[Rule]", "\<\"110\"\>"}], ",", 
   RowBox[{"\<\"-1-10\"\>", "\[Rule]", "\<\"110\"\>"}], ",", 
   RowBox[{"\<\"101\"\>", "\[Rule]", "\<\"011\"\>"}], ",", 
   RowBox[{"\<\"011\"\>", "\[Rule]", "\<\"011\"\>"}], ",", 
   RowBox[{"\<\"0-11\"\>", "\[Rule]", "\<\"011\"\>"}], ",", 
   RowBox[{"\<\"-101\"\>", "\[Rule]", "\<\"011\"\>"}], ",", 
   RowBox[{"\<\"10-1\"\>", "\[Rule]", "\<\"01-1\"\>"}], ",", 
   RowBox[{"\<\"01-1\"\>", "\[Rule]", "\<\"01-1\"\>"}], ",", 
   RowBox[{"\<\"0-1-1\"\>", "\[Rule]", "\<\"01-1\"\>"}], ",", 
   RowBox[{"\<\"-10-1\"\>", "\[Rule]", "\<\"01-1\"\>"}], ",", 
   RowBox[{"\<\"111\"\>", "\[Rule]", "\<\"111\"\>"}], ",", 
   RowBox[{"\<\"1-11\"\>", "\[Rule]", "\<\"111\"\>"}], ",", 
   RowBox[{"\<\"-111\"\>", "\[Rule]", "\<\"111\"\>"}], ",", 
   RowBox[{"\<\"-1-11\"\>", "\[Rule]", "\<\"111\"\>"}], ",", 
   RowBox[{"\<\"11-1\"\>", "\[Rule]", "\<\"1-1-1\"\>"}], ",", 
   RowBox[{"\<\"1-1-1\"\>", "\[Rule]", "\<\"1-1-1\"\>"}], ",", 
   RowBox[{"\<\"-11-1\"\>", "\[Rule]", "\<\"1-1-1\"\>"}], ",", 
   RowBox[{"\<\"-1-1-1\"\>", "\[Rule]", "\<\"1-1-1\"\>"}], ",", 
   RowBox[{"\<\"002\"\>", "\[Rule]", "\<\"002\"\>"}], ",", 
   RowBox[{"\<\"00-2\"\>", "\[Rule]", "\<\"00-2\"\>"}], ",", 
   RowBox[{"\<\"200\"\>", "\[Rule]", "\<\"200\"\>"}], ",", 
   RowBox[{"\<\"020\"\>", "\[Rule]", "\<\"200\"\>"}], ",", 
   RowBox[{"\<\"0-20\"\>", "\[Rule]", "\<\"200\"\>"}], ",", 
   RowBox[{"\<\"-200\"\>", "\[Rule]", "\<\"200\"\>"}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{{3.775201552437687*^9, 3.77520156766891*^9}, 
   3.775201694672065*^9, 3.775201888974248*^9, 3.775202026695788*^9, 
   3.7752031264838037`*^9, 3.7752031740771217`*^9},
 CellLabel->
  "Out[152]=",ExpressionUUID->"4b4666f8-0dfd-484f-b0d0-8d8da46ae8d5"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"assocReverse", " ", "=", " ", 
   RowBox[{"AssociationThread", "[", 
    RowBox[{
     RowBox[{"MomentumToString", " ", "/@", " ", "utm2Flat"}], ",", " ", 
     RowBox[{"assocReverseForTotalMomentum", " ", "/@", " ", "utm2Flat"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.775201897903399*^9, 3.77520190526588*^9}, {
   3.7752019454774113`*^9, 3.775201969274123*^9}, 3.7752031854950943`*^9, {
   3.775203221788764*^9, 3.775203224318969*^9}},
 CellLabel->
  "In[155]:=",ExpressionUUID->"f8eca659-5200-49eb-a345-dcf73ce283ba"],

Cell[BoxData[
 RowBox[{
  RowBox[{"WriteString", "[", 
   RowBox[{"\"\<orbit_reference_1.js\>\"", ",", " ", 
    RowBox[{"ExportString", "[", 
     RowBox[{"assocReverse", ",", " ", "\"\<JSON\>\""}], "]"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.775203195363587*^9, 3.77520323382821*^9}},
 CellLabel->
  "In[156]:=",ExpressionUUID->"498c2782-1576-4db8-a113-b4419d6b8579"]
}, Open  ]]
},
WindowSize->{956, 1025},
WindowMargins->{{0, Automatic}, {26, Automatic}},
FrontEndVersion->"12.0 for Linux x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 162, 3, 99, "Title",ExpressionUUID->"3211ee80-6e7c-4174-8462-97c45d3a4184"],
Cell[745, 27, 378, 7, 60, "Text",ExpressionUUID->"5223c4cb-0aa5-40f4-b656-5e7cbe94a84a"],
Cell[1126, 36, 416, 10, 55, "Input",ExpressionUUID->"8b42a5b2-8c76-400b-9ec7-4cf13d4f0951"],
Cell[CellGroupData[{
Cell[1567, 50, 1240, 24, 78, "Input",ExpressionUUID->"618912da-8c58-47bd-8585-310010ac88ac"],
Cell[2810, 76, 4016, 134, 128, "Output",ExpressionUUID->"752c8241-26a7-425f-90b6-62bf9d754169"]
}, Open  ]],
Cell[6841, 213, 1897, 51, 193, "Input",ExpressionUUID->"7e456071-e75c-42c1-a031-79c90d92c02b"],
Cell[CellGroupData[{
Cell[8763, 268, 2515, 60, 285, "Input",ExpressionUUID->"887fbf27-7f99-442a-9421-04b5f53fdf2d"],
Cell[11281, 330, 2385, 41, 105, "Output",ExpressionUUID->"4b4666f8-0dfd-484f-b0d0-8d8da46ae8d5"]
}, Open  ]],
Cell[13681, 374, 572, 12, 55, "Input",ExpressionUUID->"f8eca659-5200-49eb-a345-dcf73ce283ba"],
Cell[14256, 388, 383, 9, 31, "Input",ExpressionUUID->"498c2782-1576-4db8-a113-b4419d6b8579"]
}, Open  ]]
}
]
*)

